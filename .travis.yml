# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#services:
#  - docker
#install:
#  - docker pull apachedoris/doris-dev:build-env-1.2
 #- docker run -d apachedoris/doris-dev:build-env-1.2 -v /home/travis/build/wanpengfei-git/incubator-doris/:/root/incubator-doris apachedoris/doris-dev:build-env-1.2
#  - docker run -d  -v /Users/wanpengfei/doris/incubator-doris:/root/incubator-doris apachedoris/doris-dev:build-env-1.2 bash -c  "cd /root/incubator-doris; sh build.sh --fe"


# install sys dependency
install:
  - sudo apt-get install g++ ant cmake zip byacc flex automake libtool binutils-dev libiberty-dev bison python2.7 libncurses5-dev lsb-release mlocate
  - export REPOSITORY_URL=https://doris-incubating-repo.bj.bcebos.com/thirdparty
  - cd $TRAVIS_BUILD_DIR/; sh thirdparty/build-thirdparty.sh

matrix:
  include:
    - language: c++ 
      script:
        - cd $TRAVIS_BUILD_DIR; sh build.sh --be 
        - cd $TRAVIS_BUILD_DIR; sh run-ut.sh

    - language: java 
      jdk: openjdk8 
      script:
        - cd $TRAVIS_BUILD_DIR; sh build.sh --fe 
        - cd $TRAVIS_BUILD_DIR; sh run-ut-fe.sh




#script:
#  - docker exec apachedoris/doris-dev:build-env-1.2 bash /root/incubator-doris/build.sh
#jobs:
#  include:
#    - stage: build
      # parallel be and fe build
#      script: docker exec build bash /root/build.sh 

#    - stage: unittest
      # parallel be and fe unittest
#      script: docker exec build bash /root/run-ut.sh
#    - script: docker exec build bash /root/run-fe-ut.sh

    
